!function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return i(r||t)},l,l.exports,t,e,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){!function(t,r){void 0!==e?e.exports=r():"function"==typeof define&&"object"==typeof define.amd?define(r):this.domready=r()}(0,function(t){function e(t){for(u=1;t=n.shift();)t()}var r,n=[],i=document,o=i.documentElement,a=o.doScroll,s=a?/^loaded|^c/:/^loaded|c/,u=s.test(i.readyState);return i.addEventListener&&i.addEventListener("DOMContentLoaded",r=function(){i.removeEventListener("DOMContentLoaded",r,!1),e()},!1),a&&i.attachEvent("onreadystatechange",r=function(){/^c/.test(i.readyState)&&(i.detachEvent("onreadystatechange",r),e())}),t=a?function(e){self!=top?u?e():n.push(e):function(){try{o.doScroll("left")}catch(r){return setTimeout(function(){t(e)},50)}e()}()}:function(t){u?t():n.push(t)}})},{}],2:[function(t,e,r){function n(t){if(t)return i(t)}function i(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}e.exports=n,n.prototype.on=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){n.off(t,r),e.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},e._off=r,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(1==arguments.length)return delete this._callbacks[t],this;var n=r.indexOf(e._off||e);return~n&&r.splice(n,1),this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],3:[function(t,e,r){e.exports=function(t,e,r){for(var n=0,i=t.length,o=3==arguments.length?r:t[n++];n<i;)o=e.call(null,o,t[n],++n,t);return o}},{}],4:[function(t,e,r){function n(){}function i(t){switch({}.toString.call(t)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(){if(g.XMLHttpRequest&&("file:"!=g.location.protocol||!g.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}return!1}function a(t){return t===Object(t)}function s(t){if(!a(t))return t;var e=[];for(var r in t)null!=t[r]&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}function u(t){for(var e,r,n={},i=t.split("&"),o=0,a=i.length;o<a;++o)r=i[o],e=r.split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]);return n}function c(t){var e,r,n,i,o=t.split(/\r?\n/),a={};o.pop();for(var s=0,u=o.length;s<u;++s)r=o[s],e=r.indexOf(":"),n=r.slice(0,e).toLowerCase(),i=b(r.slice(e+1)),a[n]=i;return a}function l(t){return t.split(/ *; */).shift()}function f(t){return m(t.split(/ *; */),function(t,e){var r=e.split(/ *= */),n=r.shift(),i=r.shift();return n&&i&&(t[n]=i),t},{})}function h(t,e){e=e||{},this.req=t,this.xhr=this.req.xhr,this.text=this.xhr.responseText,this.setStatusProperties(this.xhr.status),this.header=this.headers=c(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text):null}function p(t,e){var r=this;y.call(this),this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",function(){var e=new h(r);"HEAD"==t&&(e.text=null),r.callback(null,e)})}function d(t,e){return"function"==typeof e?new p("GET",t).end(e):1==arguments.length?new p("GET",t):new p(t,e)}var y=t("emitter"),m=t("reduce"),g="undefined"==typeof window?this:window,b="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};d.serializeObject=s,d.parseString=u,d.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},d.serialize={"application/x-www-form-urlencoded":s,"application/json":JSON.stringify},d.parse={"application/x-www-form-urlencoded":u,"application/json":JSON.parse},h.prototype.get=function(t){return this.header[t.toLowerCase()]},h.prototype.setHeaderProperties=function(t){var e=this.header["content-type"]||"";this.type=l(e);var r=f(e);for(var n in r)this[n]=r[n]},h.prototype.parseBody=function(t){var e=d.parse[this.type];return e?e(t):null},h.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=t,this.statusType=e,this.info=1==e,this.ok=2==e,this.clientError=4==e,this.serverError=5==e,this.error=(4==e||5==e)&&this.toError(),this.accepted=202==t,this.noContent=204==t||1223==t,this.badRequest=400==t,this.unauthorized=401==t,this.notAcceptable=406==t,this.notFound=404==t,this.forbidden=403==t},h.prototype.toError=function(){var t=this.req,e=t.method,r=t.path,n="cannot "+e+" "+r+" ("+this.status+")",i=new Error(n);return i.status=this.status,i.method=e,i.path=r,i},d.Response=h,y(p.prototype),p.prototype.timeout=function(t){return this._timeout=t,this},p.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},p.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},p.prototype.set=function(t,e){if(a(t)){for(var r in t)this.set(r,t[r]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},p.prototype.getHeader=function(t){return this._header[t.toLowerCase()]},p.prototype.type=function(t){return this.set("Content-Type",d.types[t]||t),this},p.prototype.accept=function(t){return this.set("Accept",d.types[t]||t),this},p.prototype.auth=function(t,e){var r=btoa(t+":"+e);return this.set("Authorization","Basic "+r),this},p.prototype.query=function(t){return"string"!=typeof t&&(t=s(t)),t&&this._query.push(t),this},p.prototype.send=function(t){var e=a(t),r=this.getHeader("Content-Type");if(e&&a(this._data))for(var n in t)this._data[n]=t[n];else"string"==typeof t?(r||this.type("form"),r=this.getHeader("Content-Type"),this._data="application/x-www-form-urlencoded"==r?this._data?this._data+"&"+t:t:(this._data||"")+t):this._data=t;return e?(r||this.type("json"),this):this},p.prototype.callback=function(t,e){var r=this._callback;return 2==r.length?r(t,e):t?this.emit("error",t):void r(e)},p.prototype.crossDomainError=function(){var t=new Error("Origin is not allowed by Access-Control-Allow-Origin");t.crossDomain=!0,this.callback(t)},p.prototype.timeoutError=function(){var t=this._timeout,e=new Error("timeout of "+t+"ms exceeded");e.timeout=t,this.callback(e)},p.prototype.withCredentials=function(){return this._withCredentials=!0,this},p.prototype.end=function(t){var e=this,r=this.xhr=o(),a=this._query.join("&"),s=this._timeout,u=this._data;if(this._callback=t||n,r.onreadystatechange=function(){if(4==r.readyState)return 0==r.status?e.aborted?e.timeoutError():e.crossDomainError():void e.emit("end")},r.upload&&(r.upload.onprogress=function(t){t.percent=t.loaded/t.total*100,e.emit("progress",t)}),s&&!this._timer&&(this._timer=setTimeout(function(){e.abort()},s)),a&&(a=d.serializeObject(a),this.url+=~this.url.indexOf("?")?"&"+a:"?"+a),r.open(this.method,this.url,!0),this._withCredentials&&(r.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof u&&!i(u)){var c=d.serialize[this.getHeader("Content-Type")];c&&(u=c(u))}for(var l in this.header)null!=this.header[l]&&r.setRequestHeader(l,this.header[l]);return r.send(u),this},d.Request=p,d.get=function(t,e,r){var n=d("GET",t);return"function"==typeof e&&(r=e,e=null),e&&n.query(e),r&&n.end(r),n},d.head=function(t,e,r){var n=d("HEAD",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.del=function(t,e){var r=d("DELETE",t);return e&&r.end(e),r},d.patch=function(t,e,r){var n=d("PATCH",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.post=function(t,e,r){var n=d("POST",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},d.put=function(t,e,r){var n=d("PUT",t);return"function"==typeof e&&(r=e,e=null),e&&n.send(e),r&&n.end(r),n},e.exports=d},{emitter:2,reduce:3}],5:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e){var r=this;n(this,t),this.candidates=e;var i=[{re:new RegExp(""+this.constructor.re.start+this.constructor.yearAndMonthName.parts.map(function(t){return r.constructor.re[t]}).join(this.constructor.re.separatorMonth)+this.constructor.re.end),year:this.constructor.yearAndMonthName.year,month:this.constructor.yearAndMonthName.month,name:!0}];this.patterns=i.concat(["yearAndMonth","monthDayYear","monthNameDayYear","monthYear","monthNameAndYear","year"].map(function(t){return r.constructor[t]}).map(function(t){return{re:new RegExp(""+r.constructor.re.start+t.parts.map(function(t){return r.constructor.re[t]}).join(r.constructor.re.separator)+r.constructor.re.end),year:t.year,month:t.month,name:t.name}})),this.extracted=this.constructor.compact(this.candidates.map(function(t){return r.extract(t)})),this.sorted=this.extracted.sort(function(t,e){return t[0]+"-"+(t[1]||99)<e[0]+"-"+(e[1]||99)?-1:1}),this.publicationDate=this.sorted[0]}return i(t,[{key:"extract",value:function(t){for(var e=["january","february","march","april","may","june","july","august","september","october","november","december"],r=0;r<this.patterns.length;r+=1){var n=this.patterns[r],i=t.match(n.re);if(i){var o=null;if(n.month&&(o=i[n.month],n.name))for(var a=o.toLowerCase(),s=0;s<e.length;s+=1){var u=e[s],c=u.match(a);c&&(o=String(e.indexOf(u)+1))}return this.constructor.compact([i[n.year],o])}}return null}}],[{key:"compact",value:function(t){return t.filter(function(t){return void 0!==t&&null!==t})}}]),t}();o.re={year:"(19\\d{2}|20\\d{2})",month:"(\\d{1,2})",monthName:"(\\w{3,9})",day:"\\d{1,2}",start:"(\\D|^)",end:"(\\D|$)",separator:"\\D+",separatorMonth:"\\W+"},o.yearAndMonth={parts:["year","month"],year:2,month:3},o.yearAndMonthName={parts:["year","monthName"],year:2,month:3,name:!0},o.monthDayYear={parts:["month","day","year"],year:3,month:2},o.monthNameDayYear={parts:["monthName","day","year"],year:3,month:2,name:!0},o.monthYear={parts:["month","year"],year:3,month:2},o.monthNameAndYear={parts:["monthName","year"],year:3,month:2,name:!0},o.year={parts:["year"],year:2},e.exports={DateParser:o}},{}],6:[function(t,e,r){"use strict";e.exports=function(t){return t.replace(/_([a-z])/g,function(t){return t[1].toUpperCase()})}},{}],7:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./sources"),a=t("./DateParser"),s=a.DateParser,u=t("./camelCase"),c=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n(this,t),!e)throw new Error("document is required for new MetaExtractor instance");this.options=r,this.parse(e)}return i(t,[{key:"parse",value:function(t){var e=this,r=this.options.sources||this.constructor.defaultSources,n=this.options.meta_extractor_options,i=void 0===n?{prioritizeSelectors:void 0}:n,a=i.prioritizeSelectors;a&&(this.options.prioritizeSelectors=a,r=r.reduce(function(t,e){return"Selectors"===e?[e].concat(t):(t.push(e),t)},[])),this.sources=r.map(function(r){return new("string"==typeof r?o[r]:r)(t,e.options)}),[].slice.call(t.querySelectorAll("meta")).forEach(function(t){e.sources.forEach(function(e){e.add(t)})}),(this.options.tags||this.constructor.defaultTags).forEach(function(t){if("publication_date"===t){var r=new s(e.forCompact("publication_date")),n=r.publicationDate;n&&(e.publicationYear=n[0],e.publicationMonth=n[1])}else{var i="get"+e.constructor.ucCamelCase(t);e[u(t)]=e[i]?e[i]():e.firstFor(t)}})}},{key:"getPubmedId",value:function(){return this.firstFor("pubmed_id",Number)}},{key:"getDoi",value:function(){var t=this.firstFor("doi");if(t)return t.trim().replace("doi:","").replace("info:doi/","").replace("http://","").replace("https://","").replace("dx.doi.org/","").replace("doi.org/","").replace("doi","").replace("DOI","")}},{key:"getIssn",value:function(){var t=this.firstFor("issn");if(t)return t.trim().replace("issn:","").replace("info:issn/","")}},{key:"getAuthors",value:function(){var t=this.constructor.uniq(this.forCompact("authors"));return t.length>1?t[0]+" et al.":t[0]}},{key:"getAbstract",value:function(){var t=this.options.prioritizeSelectors?0:7;return this.sources[t].get("abstract")||this.firstFor("abstract")}},{key:"firstFor",value:function(t,e){var r=this.forCompact(t);return e&&(r=r.filter(e)),r[0]}},{key:"forCompact",value:function(t){var e=[];return this.sources.map(function(e){return e.get(t)}).forEach(function(t){e=e.concat(t)}),this.constructor.compact(e)}},{key:"publication_year",get:function(){return this.publicationYear},set:function(t){this.publicationYear=t}},{key:"publication_month",get:function(){return this.publicationMonth},set:function(t){this.publicationMonth=t}},{key:"journal_title",get:function(){return this.journalTitle.trim()},set:function(t){this.journalTitle=t}},{key:"custom_id",get:function(){return this.customId},set:function(t){this.customId=t}}],[{key:"ucCamelCase",value:function(t){var e=u(t);return e.charAt(0).toUpperCase()+e.substr(1)}},{key:"compact",value:function(t){return t.filter(function(t){return void 0!==t&&null!==t})}},{key:"uniq",value:function(t){return t.filter(function(e,r){return t.indexOf(e)===r})}}]),t}();c.defaultSources=["HighWire","DublinCore","DCTerms","Prism","BEPress","EPrints","WolterKluwer","Selectors","OpenGraph"],c.defaultTags=["pubmed_id","doi","title","publication_date","authors","abstract"],e.exports={MetaExtractor:c,sources:o}},{"./DateParser":5,"./camelCase":6,"./sources":20}],8:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.prefix=["bepress","citation"],s.separator="_",e.exports=s},{"./Source":17}],9:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.defaultTags=["issn","journal_title","doi"],s.prefix="dcsext.wt",s.separator="_",s.issn="issn",s.journalTitle="name",s.doi="doi",e.exports=s},{"./Source":17}],10:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.defaultTags=["pubmed_id","doi","title","authors","abstract"],s.prefix="dcterms",s.authors="creator",s.abstract=["abstract","description"],s.journalTitle="publisher",s.issn="identifier.issn",e.exports=s},{"./Source":17}],11:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},u=t("./Source"),c=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,[{key:"getIssn",value:function(){for(var t=this.forCompact("issn"),e=0;e<t.length;e+=1){var r=t[e];if(!this.constructor.checkDoi(r))return r}}},{key:"sortScore",value:function(t,r){var n=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"sortScore",this).call(this,t,r);if("doi"===t||"issn"===t){n*=10;var i=r.getAttribute("scheme");i&&i.toLowerCase()===t&&(n-=5);var o=this.clean(r.getAttribute("content"));o&&0===o.toLowerCase().indexOf(t+":")&&(n-=1)}return n}}]),e}(u);c.prefix="dc",c.doi=["identifier.doi","identifier"],c.authors=["creator","contributor"],c.publicationDate=["date","issued"],c.abstract=["abstract","description"],c.journalTitle="publisher",c.issn=["identifier.issn","identifier"],e.exports=c},{"./Source":17}],12:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.prefix="eprints",s.authors="creators_name",s.journalTitle=["publication","publisher"],e.exports=s},{"./Source":17}],13:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.prefix="citation",s.separator="_",e.exports=s},{"./Source":17}],14:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=function t(e,r,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,r);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,r,n)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(n)},u=t("./Source"),c=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,null,[{key:"nodeTag",value:function(t){var r=t.getAttribute("property");return r?r.toLowerCase():s(e.__proto__||Object.getPrototypeOf(e),"nodeTag",this).call(this,t)}}]),e}(u);c.prefix="og",c.separator=":",c.authors=[],c.publicationDate="article:published_time",c.abstract="description",e.exports=c},{"./Source":17}],15:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.prefix="prism",s.publicationDate="publicationdate",s.journalTitle="publicationname",s.issn=["eissn","issn"],e.exports=s},{"./Source":17}],16:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Source"),u=function(t){function e(t,r){n(this,e);var o=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return o.options.selectors=o.options.selectors||{},o.buckets={},o.tags.forEach(function(t){o.options.selectors[t]&&(o.buckets[t]=[].slice.call(o.document.querySelectorAll(o.options.selectors[t])).map(function(t){return"META"===t.tagName?t.content:t.textContent}))}),o}return o(e,t),a(e,[{key:"forCompact",value:function(t){return this.buckets[t]||[]}},{key:"add",value:function(){this.added=this.added}}]),e}(s);e.exports=u},{"./Source":17}],17:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("../camelCase"),a=function(){function t(e){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t),this.document=e,this.options=i,this.tags=this.options.tags||this.constructor.defaultTags,this.tagMap={},this.buckets={},this.tagOrder={},this.tags.forEach(function(t){r.buckets[t]=[],r.tagOrder[t]=[],[].concat(r.constructor[o(t)]).forEach(function(e){var n=r.constructor.tag(e);r.tagMap[n]=r.tagMap[n]||[],r.tagMap[n].push(t),r.tagOrder[t].push(n)})})}return i(t,[{key:"add",value:function(t){var e=this,r=this.constructor.nodeTag(t);(this.tagMap[r]||[]).forEach(function(r){t.getAttribute("content")&&e.buckets[r].push(t)})}},{key:"get",value:function(t){var e="get"+this.constructor.ucCamelCase(t);return"function"==typeof this[e]?this[e]():this.firstFor(t)}},{key:"getAuthors",value:function(){return this.forCompact("authors")}},{key:"getPublicationDate",value:function(){return this.forCompact("publication_date")}},{key:"getAbstract",value:function(){var t=this.forCompact("abstract");return t&&t.length?t.join(" ").trim():null}},{key:"getDoi",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"doi",e=this.forCompact(t),r=0;r<e.length;r+=1){var n=e[r];if(this.constructor.checkDoi(n))return n}}},{key:"firstFor",value:function(t){return this.forCompact(t)[0]}},{key:"forCompact",value:function(t){var e=this;return this.buckets[t]?this.buckets[t].sort(function(r,n){return e.sortScore(t,r)-e.sortScore(t,n)}).map(function(t){var r=t.getAttribute?t.getAttribute("content"):t;return e.clean(r)}):[]}},{key:"sortScore",value:function(t,e){return(this.tagOrder[t]||"").indexOf(this.constructor.nodeTag(e))}},{key:"clean",value:function(t){return this.htmlDecode(t).replace(/^\s+|\s+$/g,"").replace(/\s*[\n\t]+\s*/g," ")}},{key:"htmlDecode",value:function(t){var e=this.document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?"":e.childNodes[0].textContent}}],[{key:"checkDoi",value:function(t){return t.match(/\//g)}},{key:"tag",value:function(t){return[].concat(this.prefix).concat(t).join(this.separator)}},{key:"nodeTag",value:function(t){var e=t.getAttribute("name");return e?e.toLowerCase():"invalid"}},{key:"ucCamelCase",value:function(t){var e=o(t);return e.charAt(0).toUpperCase()+e.substr(1)}}]),t}();a.prefix=[],a.separator=".",a.defaultTags=["pubmed_id","doi","title","authors","publication_date","abstract"],a.pubmedId=["pubmed_id","pmid"],a.doi="doi",a.title="title",a.authors=["authors","author"],a.publicationDate=["publication_date","date"],a.abstract="abstract",a.journalTitle=["journal_title","journal_abbrev"],a.issn="issn",e.exports=a},{"../camelCase":6}],18:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("./Source"),u=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),a(e,[{key:"getCustomId",value:function(){var t=this.document.querySelector('meta[name="pbContext"]');if(t&&t.content){var e=new RegExp("journal\\:journal\\:(\\w+?)(?:\\W|$)").exec(t.content);if(e&&e.length>1)return e[1]}return null}}]),e}(s);e.exports=u},{"./Source":17}],19:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=t("./Source"),s=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),e}(a);s.prefix="wkhealth",s.separator="_",e.exports=s},{"./Source":17}],20:[function(t,e,r){"use strict";var n=t("./Source"),i=t("./HighWire"),o=t("./DublinCore"),a=t("./Prism"),s=t("./BEPress"),u=t("./EPrints"),c=t("./OpenGraph"),l=t("./WolterKluwer"),f=t("./DCTerms"),h=t("./Selectors"),p=t("./TandFonline"),d=t("./DCSext");e.exports={Source:n,HighWire:i,DublinCore:o,Prism:a,BEPress:s,EPrints:u,OpenGraph:c,WolterKluwer:l,DCTerms:f,Selectors:h,TandFonline:p,DCSext:d}},{"./BEPress":8,"./DCSext":9,"./DCTerms":10,"./DublinCore":11,"./EPrints":12,"./HighWire":13,"./OpenGraph":14,"./Prism":15,"./Selectors":16,"./Source":17,"./TandFonline":18,"./WolterKluwer":19}],21:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(){function t(e){var r=this;n(this,t),
e&&(e.split(",").forEach(function(t){if(-1!==t.indexOf("=")){var e=t.split("="),n=i(e,2),o=n[0],a=n[1];r[r.trim(o)]=r.trim(a)}else r[r.trim(t)]=!0}),this.abstract=parseInt(this.abstract,10))}return o(t,[{key:"trim",value:function(t){return t.replace(/^\s+|\s+$/g,"")}}]),t}();r.default=a},{}],22:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("superagent"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=t("trendmd-meta-extractor"),u=function(){function t(e){var r=e.apiUrl,i=e.options,o=e.version,a=e.tag;if(n(this,t),this.apiUrl=r,this.options=i,this.loadingTimes={start:new Date},this.version=o,this.tag=a,this.options.journal_id)this.endpoint="/journals/"+this.options.journal_id+"/selectors",this.params={};else{this.endpoint="/journals/identification";var u=new s.MetaExtractor(window.document,{sources:["HighWire","DCSext","DublinCore","DCTerms","Prism","BEPress","EPrints","WolterKluwer","TandFonline"],tags:["doi","issn","journal_title","custom_id"]});this.params={doi:u.doi,issn:u.issn,url:this.options.url||window.location.href,custom_id:this.options.custom_id||u.custom_id}}}return i(t,[{key:"retrieve",value:function(t){var e=this;return a.default.get(this.apiUrl+this.endpoint).set(this.tag+"-widget-version",this.version).withCredentials().query(this.params).end(function(r,n){var i=new Date-e.loadingTimes.start;return"/journals/identification"===e.endpoint?e.loadingTimes.identification=i:e.loadingTimes.selectors=i,r||n.error?null:t(n.body.journal)})}}]),t}();r.default=u},{superagent:4,"trendmd-meta-extractor":7}],23:[function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=t("superagent"),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=function(){function t(e){var r=e.tag,n=e.relevancyUrl,a=e.journalId,s=e.articleId,u=e.element,c=e.loadingTimes,l=e.dtObj,f=e.version,h=e.switches,p=e.testID;i(this,t),this.tag=r,this.eventsEndpoint="/events",this.attributes={articleId:"data-"+this.tag+"-id",journalId:"data-"+this.tag+"-journal-id",sponsored:"data-"+this.tag+"-sponsored",campaignId:"data-"+this.tag+"-campaign-id",ct:"data-"+this.tag+"-ct"},this.selectors={organic:"a[data-"+this.tag+'-sponsored="false"]',sponsored:"a[data-"+this.tag+'-sponsored="true"]'},this.relevancyUrl=n,this.journalId=a,this.articleId=s,this.element=u,this.dtObj=l,this.testID=p,this.version=f,this.loadingTimes=c;var d=this.element.addEventListener?["addEventListener","click"]:["attachEvent","onclick"],y=o(d,2);this.listenMethod=y[0],this.listenEvent=y[1],this.switches=h}return a(t,[{key:"calculate",value:function(){this.calculateImpressions(),this.calculateRecommendations()}},{key:"calculateDt",value:function(){return this.log({},{dt:this.dtObj})}},{key:"gaConsent",value:function(t,e,r){return this.log({},{gdprGa:{enabled:t,code:e,clientId:r}})}},{key:"calculateImpressions",value:function(){for(var t=[],e=[],r=this.nodes("organic"),n=0;n<r.length;n++)e.push(this.params(r[n])),t.push(r[n].getAttribute(this.attributes.ct));for(var i=[],o=this.nodes("sponsored"),a=0;a<o.length;a++)i.push(this.params(o[a])),t.push(o[a].getAttribute(this.attributes.ct));return this.log({"organic-impressions":e,"sponsored-impressions":i},{"loading-times":this.loadingTimes,dt:this.dtObj,testID:this.testID,ct:t})}},{key:"calculateRecommendations",value:function(){var t=this;Object.keys(this.selectors).forEach(function(e){if("all"!==e)for(var r=t.nodes(e),n=0;n<r.length;n++)t.addClickLogger(r[n],e)})}},{key:"addClickLogger",value:function(t,e){var r=this,i=t.getAttribute(this.attributes.ct);return t[this.listenMethod](this.listenEvent,function(){return r.log(n({},e+"-recommendations",[r.params(t)]),{dt:r.dtObj,testID:r.testID,ct:i})})}},{key:"nodes",value:function(t){return this.element.querySelectorAll(this.selectors[t])}},{key:"params",value:function(t){return{from_journal_id:this.journalId,from_article_id:this.articleId,to_journal_id:t.getAttribute(this.attributes.journalId),to_article_id:t.getAttribute(this.attributes.articleId),campaign_id:t.getAttribute(this.attributes.campaignId)}}},{key:"log",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.switches=this.switches||{},u.default.post(this.relevancyUrl+this.eventsEndpoint).set(this.tag+"-widget-version",this.version).withCredentials().send({events:t,misc:e}).end()}}]),t}();r.default=c},{superagent:4}],24:[function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=t("domready"),s=n(a),u=t("superagent"),c=n(u),l=t("trendmd-meta-extractor"),f=t("./Relevancy"),h=n(f),p=t("./ArticleHeader"),d=n(p),y=t("./JournalRetriever"),m=n(y);s.default.domready=s.default;var g=function(){function t(e){var r=this,n=e.tag,o=e.apiUrl,a=e.relevancyUrl,u=e.styleSheetUrl,c=e.dt,l=e.options,f=e.version;i(this,t),this.tag=n,this.version=f,this.apiUrl=o,this.relevancyUrl=a,this.styleSheetUrl=u,this.dt=c,this.options=l,this.loadingTimes={start:new Date},this.switches={},s.default.domready(function(){r.loadingTimes.domReady=new Date-r.loadingTimes.start,r.element=document.querySelector(r.options.element),r.element&&r.retrieve(function(t){r.addDt(),r.extractor=r.metaExtractor(document,t),r.show()})})}return o(t,[{key:"metaExtractor",value:function(t,e){return new l.MetaExtractor(t,e)}},{key:"journalRetriever",value:function(){return new m.default({apiUrl:this.apiUrl,options:this.options,version:this.version,tag:this.tag})}},{key:"relevancy",value:function(t){return this._relevancy=new h.default({tag:this.tag,relevancyUrl:this.relevancyUrl,journalId:this.journal.id,element:this.element,loadingTimes:this.loadingTimes,dtObj:this.dtObj(),version:this.version,articleId:t.id,switches:this.switches}),this._relevancy}},{key:"addDt",value:function(){var t=this;if(!this.dt||!this.switches.dt||this.switches.gdpr)return!1;var e=document.createElement("iframe");if(e.setAttribute("style","display:none!important"),"function"!=typeof e.getAttribute)return!1;var r=Date.now(),n=window.location.origin,i="?client-origin="+n+"&timestamp="+r;return this.dt.permittedOrigin=""+this.dt.origin,e.src=""+this.dt.permittedOrigin+this.dt.path+i,document.body.appendChild(e),window.addEventListener("message",function(e){return t.dtPostMessageHandler(e)},!1),!0}},{key:"dtPostMessageHandler",value:function(t){t.origin===this.dt.permittedOrigin&&(this.dt.response=t.data,this.loadingTimes.dt=new Date-this.loadingTimes.start,this._relevancy&&(this._relevancy.dtObj=this.dtObj(),this._relevancy.calculateDt()))}},{key:"dtObj",value:function(){if(!this.dt||!this.switches.dt)return!1;for(var t={url:document.location.href,title:document.title,article:this.queryParams(),referrer:document.referrer,time:new Date,recos:[],iframe:{data:this.dt.response,iframeResponse:this.loadingTimes.dt,recosVisible:this.loadingTimes.recos}},e=document.getElementsByClassName(this.tag+"-widget-list-item__link"),r=0;r<e.length;r++){var n=e[r];t.recos.push(n.getAttribute("data-"+this.tag+"-id"))}return t}},{key:"retrieve",value:function(t){var e=this,r=this.journalRetriever();r.retrieve(function(n){r.loadingTimes.identification?e.loadingTimes.identification=r.loadingTimes.identification:e.loadingTimes.selectors=r.loadingTimes.selectors,e.journal=n,e.switches=n.switches||{},e.switches.gaCode="UA-47018061-3",e.widgetEndpoint="/journals/"+n.id+"/similar",e.missingEndpoint="/journals/"+n.id+"/missing",e.articlesEndpoint="/journals/"+n.id+"/articles",t(n)})}},{key:"show",value:function(){var t=this,e=this.queryParams();return this.isMissing(e)?this.missing():(this.addStyle(),this.article(e,function(e,r){if(!(e||r.error&&404!==r.status&&403!==r.status)){if(404===r.status)return void t.create();var n=new d.default(r.header[t.tag+"-article"]);n.testID=r.header["X-TestID"];var i=t.extractor.abstract?t.extractor.abstract.trim().length:0;if(n.id&&n.meta_dated&&(n.missing_meta||n.abstract<i)&&t.update(n.id),403!==r.status){var o=r.text.replace(/Pending(<span.*?),\s/gm,"$1");if(t.element.innerHTML=o,t.loadingTimes.recos=new Date-t.loadingTimes.start,n.id){t.relevancy(n).calculate()}t.switches.gdpr&&!t.switches.gdprGa?t.askGaConsent():t.addGa(),"function"==typeof t.options.cb&&t.options.cb()}}}))}},{key:"article",value:function(t,e){return c.default.get(this.apiUrl+this.widgetEndpoint).set(this.tag+"-widget-version",this.version).withCredentials().query(t).end(e)}},{key:"missing",value:function(){this.nonMissingUrl()||c.default.post(this.apiUrl+this.missingEndpoint).set(this.tag+"-widget-version",this.version).send({url:this.options.url||window.location.href}).end()}},{key:"create",value:function(t){c.default.post(this.apiUrl+this.articlesEndpoint).set(this.tag+"-widget-version",this.version).send(this.storeParams()).end(t)}},{key:"update",value:function(t,e){c.default.put(""+this.apiUrl+this.articlesEndpoint+"/"+t).set(this.tag+"-widget-version",this.version).send(this.storeParams()).end(e)}},{key:"queryParams",value:function(){return this.params("pubmed_id","doi","title","authors","url","publication_year","publication_month")}},{key:"storeParams",value:function(){return this.params("pubmed_id","doi","title","authors","url","publication_year","publication_month","abstract")}},{key:"params",value:function(){for(var t=this,e={},r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return-1!==n.indexOf("url")&&(e.url=this.options.url||window.location.href),n.forEach(function(r){"url"!==r&&(e[r]=t.checkParam(r,t.options[r]||t.extractor[r]))}),e}},{key:"checkParam",value:function(t,e){return"publication_year"===t?e>=1900&&e<=2100?e:null:"publication_month"===t?e>=1&&e<=12?e:null:e}},{key:"isMissing",value:function(t){return this.missingParameters(t)}},{key:"missingParameters",value:function(t){return!t.title&&!t.doi&&!t.pubmed_id}},{key:"nonMissingUrl",value:function(){return this.fileUrl()||this.googleCacheUrl()}},{key:"fileUrl",value:function(){return(this.options.url||window.location.href).match(/^file:\/\//)}},{key:"googleCacheUrl",value:function(){return(this.options.url||window.location.href).match(/^http:\/\/webcache\.googleusercontent\.com\/search/)}},{key:"addStyle",value:function(){var t=document.createElement("link");return t.rel="stylesheet",t.type="text/css",t.href=this.styleSheetUrl,t.media="all",document.getElementsByTagName("head")[0].appendChild(t)}},{key:"askGaConsent",value:function(){-1===document.cookie.indexOf(this.tag+"DisableGaGdprPopup")&&document.getElementsByClassName(this.tag+"-widget-cookie-notification").length&&document.getElementsByClassName(this.tag+"-widget-cookie-notification")[0].setAttribute("style","display: block!important")}},{key:"gaConsent",value:function(t){var e=this;t?this.addGa(function(r){e._relevancy.gaConsent(t,e.switches.gaCode,r)}):this._relevancy.gaConsent(t,this.switches.gaCode),document.cookie=this.tag+"DisableGaGdprPopup=1;path=/",document.getElementsByClassName(this.tag+"-widget-cookie-notification")[0].setAttribute("style","display: none!important")}},{key:"addGa",value:function(t){return function(t,e,r,n,i,o,a){t.GoogleAnalyticsObject=i,t[i]=t[i]||function(){return(t[i].q=t[i].q||[]).push(arguments)},t[i].l=1*new Date,o=e.createElement(r),a=e.getElementsByTagName(r)[0],o.async=1,o.src=n,a.parentNode.insertBefore(o,a)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",this.switches.gaCode,"auto",{storage:"none",name:"tmdWidget"}),ga("set","anonymizeIp",!0),"function"==typeof t&&ga(function(){var e=ga.getByName("tmdWidget");t(e.get("clientId"))}),ga("tmdWidget.send","pageview",window.location.hostname+"/"+this.journal.id)}}]),t}();r.default=g},{"./ArticleHeader":21,"./JournalRetriever":22,"./Relevancy":23,domready:1,superagent:4,"trendmd-meta-extractor":7}],25:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=t("./SimilarWidget"),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e){var r=e.tag,i=e.apiUrl,o=e.relevancyUrl,a=e.styleSheetUrl,s=e.dt,u=e.version;n(this,t),this.apiUrl=i,this.relevancyUrl=o,this.styleSheetUrl=a,this.dt=s,this.version=u,this.tag=r,this._getInlineConfig(),this.inlineConfig&&this.register()}return i(t,[{key:"_getURLParam",value:function(t){var e=new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)"),r=e.exec(window.location.search),n=!1;return r&&r.length&&(n=r[1].replace(/\+/g,"%20"),n=decodeURIComponent(r[1])),n}},{key:"_getInlineConfig",value:function(){var t=this,e=void 0,r=document.currentScript||function(){for(var e=document.getElementsByTagName("script"),r="",n=0;n<e.length;n++){var i=e[n];i.getAttribute("data-"+t.tag+"config")&&(r=i)}return r}();if(r&&(e=r.getAttribute("data-amp")),e){this.inlineConfig={title:this._getURLParam("title"),doi:this._getURLParam("doi"),journal_id:this._getURLParam("journalId"),issn:this._getURLParam("issn"),pubmed_id:this._getURLParam("pubmed"),url:this._getURLParam("url"),custom:this._getURLParam("custom"),element:"#"+this.tag+"-suggestions"},window.parent.postMessage({sentinel:"amp",type:"embed-size",height:document.body.scrollHeight},"*");for(var n=document.getElementsByClassName(this.tag+"-widget-list-item__link"),i=0;i<n.length;i++)n[i].setAttribute("target","_blank")}else r&&(this.inlineConfig=r.getAttribute("data-"+this.tag+"config"),this.inlineConfig&&(this.inlineConfig=this.inlineConfig.replace(/'/g,'"'),this.inlineConfig=JSON.parse(this.inlineConfig)))}},{key:"register",value:function(t){(t||this.inlineConfig)&&(this.widget=this._similarWidget({apiUrl:this.apiUrl,relevancyUrl:this.relevancyUrl,styleSheetUrl:this.styleSheetUrl,options:t||this.inlineConfig,dt:this.dt,version:this.version,tag:this.tag}))}},{key:"gaConsent",value:function(t){this.widget.gaConsent(t)}},{key:"_similarWidget",value:function(t){return new a.default(t)}}]),t}();r.default=s},{"./SimilarWidget":24}],26:[function(t,e,r){(function(e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TrendMD=r.config=void 0;var n=t("../Widget"),i=function(t){return t&&t.__esModule?t:{default:t}}(n),o=r.config={tag:"trendmd",apiUrl:"https://www.trendmd.com",relevancyUrl:"https://academia.trendmd.com",styleSheetUrl:"https://trendmd.s3.amazonaws.com/trendmd.min.css",dt:{origin:"https://www.medtargetsystem.com",path:"/beacon/portal-lite"},version:"050618-3"},a=r.TrendMD=i.default;e.TrendMD=new a(o)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../Widget":25}]},{},[26]);